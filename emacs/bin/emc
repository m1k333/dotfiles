#!/bin/bash

# Wrapper for emacs daemon and client interaction,
# and for using emacsclient as $EDITOR

# Name the arguments
choice="$@"

# Define start function
startdaemon()
{
    echo "Starting Emacs daemon...";
    emacs --daemon;
}

# Define stop function
stopdaemon()
{
    echo "Stopping Emacs daemon...";
    emacsclient --eval "(kill-emacs)";
}

# Choose what to do
case $choice in
    start)          startdaemon               ;;
    stop|quit)      stopdaemon                ;;
    restart|reboot) stopdaemon && startdaemon ;;

    *)  # Run a command through to emacsclient
        emacsargs="-c"

        # Get rid of the `-t', construct the command proper
        [[ "$1" == "-t" ]] && (shift 1 && emacsargs="-nw -c")
        scriptargs="$@"

        # Run the command!
        exec emacsclient $emacsargs --alternate-editor="" $scriptargs
        ;;
esac

#EOF
